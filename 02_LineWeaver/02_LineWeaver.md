ã‚¹ã‚«ã‚¤ãƒªãƒ MOD æ–‡è„ˆé‡è¦–ã®ç¿»è¨³è€…å‘ã‘æ”¯æ´ãƒ„ãƒ¼ãƒ« / Skyrim MOD Translation Assistant Tool 
02_LineWeaver [JP/EN]

ğŸš€ Streamlit: https://02lineweaver-nw4bb8sehxbetnh95f6cvy.streamlit.app/

ç‰¹å¾´ï¼š
- Skyrim SE/AE ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼MODã‚„ã€ã‚¯ã‚¨ã‚¹ãƒˆMODã®ç¿»è¨³ã‚’ã€è‡ªå‹•ç¿»è¨³ã ã‘ã§ã¯ãªãã€ç‰©èªã‚„ä¼šè©±ã®æµã‚Œãƒ»æ–‡è„ˆã‚’æŠŠæ¡ã—ã¦ç¿»è¨³ã—ãŸã„äººã®ãŸã‚ã®æ”¯æ´ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚  
- xTranslator / SSEEdit ã¨é€£æºã—ã€ãƒ¬ã‚³ãƒ¼ãƒ‰æƒ…å ±ã®æ•´ç†ãƒ»å¤‰æ›ãƒ»å†æ§‹ç¯‰ãŒå¯èƒ½ã€‚

ä¸»ãªæ©Ÿèƒ½ï¼š
- SSEEdit ã‹ã‚‰å‡ºåŠ›ã—ãŸæƒ…å ±ç”¨csv ã¨ xTranslatorã®xml ã‚’ãƒãƒ¼ã‚¸
- ç¿»è¨³ä½œæ¥­ã—ã‚„ã™ã„ `.xlsx` ã«å¤‰æ›ã€æœªç¿»è¨³ã‚»ãƒ«ã«ã¯è‡ªå‹•ã§è‰²ã‚’ã¤ã‘ã¦å¯è¦–åŒ–
  ï¼ˆä½œæ¥­ä¸­ã¯è¡Œåˆ—ã®å†…å®¹ã‚’ä¿æŒã—ã¦ã„ã‚Œã°ã€ä¸¦ã¹æ›¿ãˆã‚„åˆ—ã®è¿½åŠ ã‚‚å¯èƒ½ã§ã™ã€‚å‡ºåŠ›æ™‚ã€EDIDãŒç©ºæ¬„ã®è¡Œã€ãŠã‚ˆã³ã‚¿ã‚¤ãƒˆãƒ«ãŒç©ºç™½ã®åˆ—ã¯ç„¡è¦–ã•ã‚Œã¾ã™ï¼‰
- ESPæ§‹é€ é †ï¼ˆDIALâ†’INFO ã®è¦ªå­é–¢ä¿‚ï¼‰ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã‚‹ãŸã‚ã€ä¼šè©±ã®æµã‚Œã‚’æŠŠæ¡ã—ã‚„ã™ã„
- ç¿»è¨³å¾Œã® .xlsx ã‚’å…ƒã« xml ã‚’å†å¤‰æ›ã€‚xTranslator ã§å†åˆ©ç”¨å¯èƒ½
- ãƒ€ãƒ¼ã‚¯ï¼ãƒ©ã‚¤ãƒˆãƒ†ãƒ¼ãƒã«å®Œå…¨å¯¾å¿œï¼ˆStreamlitã®ãƒ†ãƒ¼ãƒåˆ‡æ›¿ã«æº–æ‹ ï¼‰

â­ ç§ã¯ã‚¯ã‚¨ã‚¹ãƒˆã‚¿ã‚¤ãƒˆãƒ«ã‚„ã‚¯ã‚¨ã‚¹ãƒˆã‚¸ãƒ£ãƒ¼ãƒŠãƒ«ã®ã‚ã¨ã«ã€ãã®ã‚¯ã‚¨ã‚¹ãƒˆã®é€²è¡Œã«æ²¿ã£ãŸä¼šè©±ã®æµã‚Œã«ä¸¦ã¹æ›¿ãˆã¦ä½¿ã£ã¦ã¾ã™ã€‚

å¤‰æ›´ãƒ­ã‚°:
- 2025-05-28 æœªç¿»è¨³ã‚»ãƒ«ã®åˆ¤å®šã‚’ASCIIã‹ã‚‰å®Œå…¨ä¸€è‡´ã¸å¤‰æ›´ã—ã¾ã—ãŸã€‚ã‚½ãƒ¼ã‚¹å…ƒã®è¨€èªã«é–¢ä¿‚ãªãã€æœªç¿»è¨³ã‚»ãƒ«ã®æ¤œå‡ºãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
- 2025-06-01 XMLå†å¤‰æ›æ™‚ã®Destè¨€èªï¼ˆç¿»è¨³å…ˆï¼‰ã‚’é¸ã¹ã‚‹ã‚ˆã†ã«UIã‚’è¿½åŠ ï¼ˆxTranslatorã§ã®ä»–è¨€èªã¸ã®ç¿»è¨³ã«å¯¾å¿œï¼‰
- 2026-02-07 .pasã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ESPæ§‹é€ é †ï¼ˆESP_Orderï¼‰ã¨DIALè¦ªå­é–¢ä¿‚ï¼ˆParentDIAL, ParentDIAL_EDIDï¼‰ã‚’è¿½åŠ ã€‚å‡ºåŠ›ãŒESPæ§‹é€ é †ã‚½ãƒ¼ãƒˆã«ãªã‚Šã€ä¼šè©±ã®æµã‚ŒãŒæŠŠæ¡ã—ã‚„ã™ããªã‚Šã¾ã—ãŸã€‚ãƒãƒ¼ã‚¸ç”¨ã®ä¸­é–“åˆ—ã‚‚å‡ºåŠ›ã‹ã‚‰é™¤å»ã€‚

ä½¿ã„æ–¹ã¨æ©Ÿèƒ½è©³ç´°ï¼š

ğŸ”¹ ã‚¹ãƒ†ãƒƒãƒ—1ï¼šSSEEditã§CSVå‡ºåŠ›
1. SSEEditã§ `02LW_step1.pas` ã‚’ã€ŒApply Scriptã€ã§å®Ÿè¡Œ 
2. `02LW_ã€‡ã€‡.csv` ã‚’å‡ºåŠ›ï¼ˆFormID, EDID, REC, Plugin, Speaker, ESP_Order, ParentDIAL, ParentDIAL_EDID ä»˜ãï¼‰
â€» .pasã®å‡ºåŠ›å…ˆã¯SSEEditãƒ•ã‚©ãƒ«ãƒ€ã€exeã¨åŒã˜éšå±¤

- "REC"ã¯ INFO:NAM1 ã¨ã‹ QUST:CNAM ã¨ã‹ã€"Speaker"ã¯"Condition"ã®"Subject,GetIsID"ã«å…¥ã£ã¦ã„ã‚‹å€¤ã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚"Referenceable Object"ã«äººç‰©ãŒæŒ‡å®šã•ã‚Œã¦ãŸã‚‰ã€ãã®äººãŒè©±è€…ã¨ã„ã†åˆ¤æ–­ã§ã™ãŒã€ã“ã“ã«å…¥ã£ã¦ãªã„å ´åˆã¯è©±è€…æƒ…å ±ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãŸã¾ã«é•ã†å€¤ãŒå…¥ã£ã¦ã„ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚

ğŸ”¹ ã‚¹ãƒ†ãƒƒãƒ—2ï¼šç¿»è¨³æº–å‚™ï¼ˆCSV + XML â†’ XLSXï¼‰
â€»ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿å¾Œã€å¤‰æ›é–‹å§‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¨ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ãŒå‡ºã¾ã™ã€‚
1. xTranslatorã§å¯¾è±¡MODã® `.esp/.esm` ã‚’èª­ã¿è¾¼ã¿ã€XMLå½¢å¼ã§å‡ºåŠ›  
2. Streamlitã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã€CSVã¨XMLã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰  
3. ã€Œxlsx ã«å¤‰æ›é–‹å§‹ã€ã§ç¿»è¨³ç”¨ `.xlsx` ã‚’ç”Ÿæˆï¼ˆæœªç¿»è¨³ã‚»ãƒ«ã«è‰²ä»˜ãï¼‰  

- å…¨ãæœªç¿»è¨³ã®çŠ¶æ…‹ã§ã‚ˆã‘ã‚Œã°xTranslatorã§espã‚’èª­ã¿è¾¼ã‚“ã å¾Œã€ã„ã£ãŸã‚“å…¨è¡Œä»®è¨³ã«ã—ã¦xmlã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦ãã ã•ã„ã€‚xmlå‡ºåŠ›å‰ã«ç¿»è¨³APIã‚’ä½¿ã£ã¦ã‚‚OKã€‚ã“ã®02LWä¸Šã§ã®å®Ÿè£…ã¯ä¸å¯ã ã¨åˆ¤æ–­ã—ã¾ã—ãŸã€‚ï¼ˆå¤šåˆ†ç„¡æ–™ã®ã‚¿ã‚¤ãƒ—ã ã¨ã€æ•°ç™¾ã¨ã‹è¶…ãˆãŸã‚‰ã™ãAPIå´ãŒæ­¢ã¾ã£ã¦å‡¦ç†ã§ããªããªã‚‹ã‹ã‚‰ã€‚æœ‰æ–™ã¨åŒºåˆ¥ã™ã‚‹ã¨ã‹ã®ã‚„ã‚Šæ–¹ãŒã‚ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚xTranslatorã§ã‚„ã‚ŠãŸããªã„ã‚ˆãƒ¼ã¨ã„ã†å ´åˆã¯ã€ãªã‚“ã‹ä»–ã®æ–¹æ³•ã‚’è€ƒãˆã¦ãã ã•ã„ï¼‰

- SSEEditã§å‡ºåŠ›ã—ãŸcsvï¼ˆ02LW_XXX.csvï¼‰ã¨xmlã®æƒ…å ±ã‚’ãƒãƒ¼ã‚¸ã—ã¾ã™ã€‚
- å‡ºåŠ›æ™‚ã€"Dest"åˆ—ã®å†…å®¹ãŒ"Source"åˆ—ã¨åŒã˜ã¾ã¾ã ã£ãŸå ´åˆã€æœªç¿»è¨³æ‰±ã„ã¨ãªã‚Šã€ãã®ã‚»ãƒ«ã«è‰²ãŒã¤ãã¾ã™ï¼ˆ=Deståˆ—ã§è‰²ãŒä»˜ã„ã¦ã„ã‚‹ã¨ã“ã‚ã‚’æ—¥æœ¬èªã«ã—ã¦ãã ã•ã„ï¼‰
- ã“ã®ã¨ãã€ä¸‹è¨˜ã®Recé …ç›®ã¯é™¤å¤–ã•ã‚Œã¾ã™ï¼ˆç¿»è¨³ã®å¿…è¦ãŒãªã„ãŸã‚ï¼‰ã€‚é€šå¸¸ç§ã¯xTranslatorã§é»„è‰²ã«ã—ã¦ã€ä»–ã®MODã‚’ä¸Šæ›¸ãã—ãªã„ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚
 "HDPT:FULL", "FURN:FULL", "CLAS:FULL", "DOOR:FULL", "FACT:FULL", "CLFM:FULL",
 "TREE:FULL", "MGEF:FULL", "RACE:FULL", "EXPL:FULL", "HAZD:FULL", "BPTD:BPTN"
 â€»"MGEF:FULL"ï¼ˆé­”æ³•ã‚¨ãƒ•ã‚§ã‚¯ãƒˆåï¼šã‚²ãƒ¼ãƒ å†…è¡¨ç¤ºãªã—ï¼‰ã¯é™¤å¤–ã™ã‚‹ã®ã«ã€"MGEF:DNAM"ï¼ˆé­”æ³•ã‚¨ãƒ•ã‚§ã‚¯ãƒˆèª¬æ˜æ–‡ï¼šã‚²ãƒ¼ãƒ å†…è¡¨ç¤ºãªã—ï¼‰ãŒã‚ã‚‹ã®ã¯ã€ãŸã¾ã«"SPEL:FULL"ï¼ˆå‘ªæ–‡ã®åå‰ï¼šã‚²ãƒ¼ãƒ å†…ã§è¡¨ç¤ºã•ã‚Œã‚‹ï¼‰ã¨"MGEF:FULL"ã«åŒã˜ã‚‚ã®ãŒã‚ã‚‹ã®ã«ã€"SPEL:FULL"ã«ã¯"SPEL:DNAM"ï¼ˆèª¬æ˜æ–‡ï¼‰ãŒãªãã€"MGEF:DNAM"ã«ã‚ã‚‹å ´åˆãŒã‚ã‚‹ã‹ã‚‰ã€‚ã‚‚ã—ã‹ã—ãŸã‚‰ã€"MGEF:DNAM"ï¼ˆé­”æ³•ã‚¨ãƒ•ã‚§ã‚¯ãƒˆèª¬æ˜æ–‡ï¼‰ãŒé­”æ³•ã®èª¬æ˜æ–‡ã«è¡¨ç¤ºã•ã‚Œã‚‹ï¼Ÿã¨ä¸å®‰ãªãŸã‚ã€‚
- "æœªç¿»è¨³æ‰±ã„"ã§è‰²ãŒä»˜ã„ã¦ã„ãŸã¨ã—ã¦ã‚‚ã€å®Ÿéš›ã«ã¯ç¿»è¨³ãŒå¿…è¦ã§ã¯ãªã„å ´åˆã‚‚ã‚ã‚‹ã®ã§ã€ãã‚Œã¯å€‹ã€…ã®MODã«åˆã‚ã›ã¦åˆ¤æ–­ã—ã¦ãã ã•ã„ã€‚

- å‡ºåŠ›å¾Œã¯ESPæ§‹é€ é †ï¼ˆDIALâ†’INFOã®è¦ªå­é–¢ä¿‚é †ï¼‰ã«ãªã£ã¦ã„ã¾ã™ãŒã€"è¡Œã®å†…å®¹ã¨ã€åˆ—ã®å†…å®¹ãŒä¿æŒã•ã‚Œã¦ã„ã‚Œã°"ä¸¦ã¹æ›¿ãˆã§ãã¾ã™ã€‚ã¾ãŸã€è‰²ä»˜ã‘ãŒå¿…è¦ãªã„å ´åˆã¯ã€CSVã§ä¿å­˜ã—ã¦ã‹ã‚‰ç·¨é›†ã—ã¦ã‚‚OKã€‚"Recåˆ—"ã‚’åŸºæº–ã«"FormID"é †ã«ä¸¦ã¹æ›¿ãˆãŸã‚Šã€è¦–èªæ€§ç¢ºä¿ã®ãŸã‚ã«ç©ºç™½ã®è¡Œã‚’è¿½åŠ ã—ãŸã‚Šã€åˆ—ã®ä½ç½®ã‚’å¤‰ãˆãŸã‚Šã€ãƒ¡ãƒ¢ç”¨ã®åˆ—ã‚’è¿½åŠ ã—ãŸã‚Šã—ã¦ã‚‚ã€ã‚¹ãƒ†ãƒƒãƒ—3ã§ã®"XMLã¸ã®å†å¤‰æ›"ã«å½±éŸ¿ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
â€»ãŸã ã—ã€åˆ—1è¡Œç›®ã®é …ç›®ï¼ˆSource, Dest ã¨ã‹ï¼‰ã¯å‰Šé™¤ã—ãªã„ã§ãã ã•ã„ã€‚XMLã¸ã®å†å¤‰æ›ã¯ã“ã“ãŒæ¬ ã‘ã¦ã‚‹ã¨ã§ãã¾ã›ã‚“ã€‚åˆ—ã‚’è¶³ã™å ´åˆã¯ã€1è¡Œç›®ã‚‚ç©ºç™½ã®ã¾ã¾ã«ã™ã‚‹ã¨ã‹ã€2è¡Œç›®ä»¥é™ã«ä»»æ„ã‚¿ã‚¤ãƒˆãƒ«ã‚’ç½®ãè¡Œã‚’è¿½åŠ ã™ã‚‹ã¨ã‹ã—ã¦ãã ã•ã„ã€‚

- æ›´æ–°ãŒã‚ã£ãŸã‚‰ã€SSEEditã‹ã‚‰ã®csvå‡ºåŠ›ã¯æ¯å›ã‚„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€"æ›´æ–°åˆ†ã®ã¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸ"xmlã‚’ä½¿ãˆã°æ›´æ–°åˆ†ã®ã¿ã®xlsxãŒã§ãã¾ã™ã€‚ãã“ã ã‘xmlã¸å†å¤‰æ›ã™ã‚‹ã‚‚ã‚ˆã—ã€æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã«è‡ªåˆ†ã§ä»˜ã‘è¶³ã™ã‚‚ã‚ˆã—ã€‚

ğŸ”¹ ã‚¹ãƒ†ãƒƒãƒ—3ï¼šç¿»è¨³æ¸ˆã¿XLSXã‚’XMLã«å†å¤‰æ›  
1. ç¿»è¨³ãŒå®Œäº†ã—ãŸ `.xlsx` ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
2. xTranslatorã§ã®ã€Œç¿»è¨³å…ˆã®è¨€èªã€ã‚’é¸ã¶
3. ã€Œxml ã«å¤‰æ›é–‹å§‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€XMLå½¢å¼ã«å¤‰æ›  
4. xTranslatorã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ `.esp` ã«é©ç”¨ â†’ å†åº¦XMLã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
   
â€»å†å¤‰æ›ã—ãŸxmlãŒé©ç”¨ã§ããªã„ç®‡æ‰€ãŒã‚ã£ãŸå ´åˆã¯ã€xTranslatorã§æ‰‹å‹•ã§ç·¨é›†ã—ã¦ãã ã•ã„ã€‚ï¼ˆåŸæ–‡ãŒä¸æ­£ãªè¨˜è¿°ã®å ´åˆã«èµ·ã“ã‚Šã¾ã™ï¼‰

- âš  é…å¸ƒç”¨ã®XMLã«ã¤ã„ã¦
å†å¤‰æ›æ©Ÿèƒ½ã§å‡ºåŠ›ã•ã‚Œã‚‹`xml`ã¯ç¿»è¨³é©ç”¨ã‚„å†å¤‰æ›ãƒ†ã‚¹ãƒˆã«ã¯ä½¿ãˆã¾ã™ãŒã€é…å¸ƒæ™‚ã«ã¯å¿…ãš"xTranslatorã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ç›´ã—ãŸxml"ã‚’ä½¿ã£ã¦ãã ã•ã„ã€‚ï¼ˆxTranslatorå†…éƒ¨ã®æ§‹é€ ã‚„å½¢å¼ã«å®Œå…¨æº–æ‹ ã—ã¦ã„ãªã„ãŸã‚ã€MODç’°å¢ƒã‚„ä»–ãƒ„ãƒ¼ãƒ«ã¨ã®äº’æ›æ€§ç¢ºä¿ã®ãŸã‚ã«ã‚‚å†å‡ºåŠ›ã‚’æ¨å¥¨ï¼‰

- å…¨ã¦UTF-8ã§å‡¦ç†ã—ã¦ã„ã‚‹ãŸã‚ã€å¤šè¨€èªã«å¯¾å¿œã§ãã¦ã‚‹ã¨æ€ã„ã¾ã™ã€‚å¤šåˆ†ã€‚
- ã‚µãƒ¼ãƒãƒ¼ã«ãƒ‡ãƒ¼ã‚¿ã¯ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚æ¯å›ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚

- ç§ãŒç¿»è¨³ã—ã¦ã‚‹MODã®æœ€å¤§è¡Œæ•°ãŒç´„8000ã§ã€ãã‚Œã«ã¯å•é¡Œãªãä½¿ç”¨ã§ãã¾ã—ãŸã€‚ã¿ã‚“ãªã‚‚ä¸Šæ‰‹ãã„ãã¨ã„ã„ãªã€‚

- è‡ªåˆ†ãŒä½¿ã„ã‚„ã™ãæ¬²ã—ã„æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ãŸã®ã§ã€ã‚‚ã—ã‹ã—ãŸã‚‰ä»–ã«ã‚‚ä¾¿åˆ©ã ã¨æ€ã†äººãŒã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã¨æ€ã„å…¬é–‹ã—ã¾ã—ãŸãŒã€è¿½åŠ æ©Ÿèƒ½ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ã‹ã¯ç‰¹ã«å‹Ÿé›†ã—ã¦ã„ã¾ã›ã‚“ã€‚

[ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ï¼šMIT] 
- ã‚¢ãƒ¬ãƒ³ã‚¸ã—ãŸã„å ´åˆã¯ã€ã”è‡ªç”±ã«ã‚½ãƒ¼ã‚¹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ã”åˆ©ç”¨ãã ã•ã„ï¼å…¬é–‹ã™ã‚‹å ´åˆã¯ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã« "02 LineWeaver" ã¨Â GitHubã®ãƒªãƒ³ã‚¯Â ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ã€‚å•†ç”¨åˆ©ç”¨ä¸å¯ã€‚

â€»ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€ŒDSDifyerã€ã‚’è¦‹ã¦ç€æƒ³ã‚’å¾—ã¾ã—ãŸã€‚ä½œè€…æ§˜ã«æ„Ÿè¬ç”³ã—ä¸Šã’ã¾ã™ï¼  
- NexusMods: https://www.nexusmods.com/skyrimspecialedition/mods/114102  
- GitHub: https://github.com/GroundAura/DSDifyer

â€»ã‚‚ã¡ã‚ã‚“ xTranslator / SSEEdit ã®ä½œè€…æ§˜ãŸã¡ã«ã‚‚æ„Ÿè¬ï¼

æŠ€è¡“å”åŠ› / Technical collaboration: Claude

---------------------------------------------------------------------------------------

02 LineWeaver - Skyrim MOD Translation Assistant Tool

- This is a support tool for those who want to translate follower and quest mods for Skyrim SE/AE not only with machine translation, but also by understanding the flow and context of the story and dialogue.
- Works alongside xTranslator and SSEEdit to organize, convert, and rebuild record data for smoother translation work.

Features:
- Merge CSV output from SSEEdit and XML from xTranslator
- Convert into a translator-friendly `.xlsx` file, with untranslated lines automatically highlighted.
  (You can sort rows or add columns as long as cell contents are preserved.
  Rows with blank EDID or columns with blank headers will be ignored during XML conversion)
- Sorted by ESP structure order (DIALâ†’INFO parent-child relationship), making it easier to follow conversation flow
- Reconvert the translated `.xlsx` back to XML for use in xTranslator
- Dark/light theme support via Streamlit's auto-switching.

â­ I usually sort the lines so that quest titles and quest journal entries come first, followed by dialogue in the order it occurs during the quest progression.

Change Log:
- 2025-05-28 Untranslated cells are now detected based on exact match between Source and Dest, instead of just checking for ASCII. This now works for any language.
- 2025-06-01 Add destination language dropdown in Step 3 for XML export compatibility with xTranslator
- 2026-02-07 Added ESP structure order (ESP_Order) and DIAL parent-child relationship (ParentDIAL, ParentDIAL_EDID) to .pas script. Output is now sorted by ESP structure order, making conversation flow easier to follow. Removed intermediate merge columns from output.

Usage & Function Details:

ğŸ”¹ Step 1: Export CSV using SSEEdit  
1. Run `02LW_step1.pas` via "Apply Script" in SSEEdit
2. Export `02LW_ã€‡ã€‡.csv` containing FormID, EDID, REC, Plugin, Speaker, ESP_Order, ParentDIAL, and ParentDIAL_EDID.
* The output CSV from the .pas script will be saved in the same folder as the SSEEdit executable.

- The "REC" field refers to records like INFO:NAM1 or QUST:CNAM.
- The "Speaker" field is extracted from a Condition where the function is Subject, GetIsID.
- If a Referenceable Object (such as an NPC) is specified there, it's considered the speaker.
- If no such value exists, the speaker information will be blank.
- Note: In rare cases, this value may not represent the actual speaker.

ğŸ”¹ Step 2: Prepare for Translation (CSV + XML â†’ XLSX)
After uploading the files, click the "Start Conversion" button. Once processing is complete, a download button will appear.

1. Load the target MOD `.esp/.esm` in xTranslator and export as XML
2. Select the destination language (Dest) for XML export using the dropdown menu
3. Launch the Streamlit app, then upload both CSV and XML  
4. Click â€œStart conversion to xlsxâ€ to generate a translation-ready `.xlsx` file with color-highlighted untranslated cells

- If you're starting from an entirely untranslated state, load the esp file in xTranslator and temporarily auto-translate all lines before exporting to XML.
- You can also use the translation API inside xTranslator before exportingâ€”this tool (02LW) doesn't support translation API integration.
(This decision was made because with free-tier APIs, translation requests often fail after a few hundred lines. Also, I couldn't figure out a way to distinguish between free and paid usage tiers.)
- If you prefer not to use xTranslator for auto-translation, you'll need to find another methodâ€”feel free to get creative!

- This step merges the CSV output from SSEEdit (02LW_XXX.csv) with the XML data from xTranslator.

- If the contents of the "Dest" column are the same as the "Source" column at the time of export, those cells will be considered untranslated and highlighted. (Please translate the highlighted cells in the Dest column into the target language)
- However, the following REC types are excluded from this check, as they typically donâ€™t require translation (I usually mark them yellow in xTranslator to avoid overwriting other mods):

"HDPT:FULL", "FURN:FULL", "CLAS:FULL", "DOOR:FULL", "FACT:FULL", "CLFM:FULL",
"TREE:FULL", "MGEF:FULL", "RACE:FULL", "EXPL:FULL", "HAZD:FULL", "BPTD:BPTN"

* "MGEF:FULL" (Magic Effect name, not shown in-game) is excluded, but "MGEF:DNAM" (Magic Effect description) is includedâ€”because sometimes, even if SPEL:FULL (spell name, shown in-game) and MGEF:FULL share the same value, SPEL:FULL may not have a DNAM field (description), while MGEF does. Just in case, I include "MGEF:DNAM", assuming it might appear in the game as the spell's description.

- Even if a cell is highlighted as "untranslated", it doesnâ€™t always mean translation is requiredâ€”use your own judgment based on the context of each MOD.
- After export, the data is sorted by ESP structure order (DIALâ†’INFO parent-child relationship). However, as long as both row content and column structure are preserved, you're free to rearrange the data.
If color highlighting isnâ€™t needed, you can also edit the file after saving it as a CSV.
- You can sort by FormID within each REC category, insert blank rows for readability, rearrange columns, or even add memo columnsâ€”none of this will affect Step 3 (reconversion to XML).

* Just make sure not to delete any of the column headers in the first row (such as Source, Dest, etc)
    These headers are required for XML reconversion.
    If you want to add new columns, either leave the first-row cell blank or insert a row below with a custom titleâ€”both methods are safe.

- If the mod has been updated, youâ€™ll need to re-export the full CSV from SSEEdit.
- However, if you only export the updated lines from xTranslator, LineWeaver can generate an .xlsx containing just the updated content.
- You can then either reconvert only that portion back to XML, or manually append it to your existing filesâ€”whichever fits your workflow!

ğŸ”¹ Step 3: Convert Translated XLSX back to XML

1. Upload your completed `.xlsx` after translation  
2. Click â€œStart conversion to XMLâ€ to re-generate the XML file  
3. Import the XML back into xTranslator and apply it to the `.esp`. You can then re-export the updated XML if needed.
- If the reconverted XML fails to apply to certain entries, please manually edit them in xTranslator.
(This can happen when the original text contains invalid formatting)

âš  About the Exported XML
- The XML generated via reconversion is intended for translation application and testing purposes only.
- Please always export the final XML from xTranslator before distribution.
- This ensures compatibility with other tools and environments, as the internal structure may not fully match xTranslatorâ€™s native format.

* All files are handled in UTF-8, so it should support multiple languagesâ€¦ hopefully!
* No data is stored on the server. Please upload your files each time you use the tool.
* The largest MOD Iâ€™ve translated so far had around 8,000 lines, and it worked just fine. I hope it works for you too!
* I created this tool to meet my own needs, and thought maybe others might find it helpful tooâ€”so Iâ€™ve shared it publicly. That said, Iâ€™m not actively taking feature requests at this time.

[License: MIT]
- Feel free to customize and adapt the source scripts for your own use.
- If you plan to redistribute them, please include credit to "02 LineWeaver" and link to the GitHub page: https://github.com/ofutonify/02_LineWeaver
- Commercial use is not permitted.

This tool was inspired by DSDifyerâ€”huge thanks to the original author!
NexusMods: https://www.nexusmods.com/skyrimspecialedition/mods/114102
GitHub: https://github.com/GroundAura/DSDifyer

Special thanks as well to the developers of 
xTranslator (https://www.nexusmods.com/skyrimspecialedition/mods/134) and 
SSEEdit (https://www.nexusmods.com/skyrimspecialedition/mods/164)!

Technical collaboration: Claude
